<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>R-TYPE: R-TYPE-PROTOCOL-SPEC</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">R-TYPE
   </div>
   <div id="projectbrief">Shoot&#39;em up game</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">R-TYPE-PROTOCOL-SPEC </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Published: November 2022</p>
<p>Author: Gabriel Ravier, Epitech</p>
<h1><a class="anchor" id="autotoc_md39"></a>
RFC - R-Type Protocol (RTP)</h1>
<h2><a class="anchor" id="autotoc_md40"></a>
1. Introduction</h2>
<p>The R-Type Protocol (RTP) is intended for use for text communications between several clients, all centered around a central server but potentially between different hosts all around the world.</p>
<p>This document describes the functions to be performed by the RTP, the programs that implement it, and the interface to programs that require its services.</p>
<h3><a class="anchor" id="autotoc_md41"></a>
1.1. Scope</h3>
<p>The RTP is intended to provide a reliable protocol for implementing the R-Type game on a network.</p>
<h3><a class="anchor" id="autotoc_md42"></a>
1.2. Interfaces</h3>
<p>The interface between RTP and the lower-level protocol (TCP [I1], RUDP [I2] or other) is essentially unspecified except that it is assumed there is a mechanism whereby data can be send back and forth asynchronously in a reliable way.</p>
<h3><a class="anchor" id="autotoc_md43"></a>
1.3. Requirements Language</h3>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 when, and only when, they appear in all capitals, as shown here.</p>
<h2><a class="anchor" id="autotoc_md44"></a>
2. Functional Specification</h2>
<h3><a class="anchor" id="autotoc_md45"></a>
2.1. Client-Server Relation</h3>
<p>RTP is an interface between clients and a single central server. Clients send packets to the server, and receive corresponding packets from it. Certain types of packets may only be sent by clients to the server, and other by the server to the client, and some packet types have different meaning depending on whether they are sent to the client or the server.</p>
<p>All integers and other multi-byte fields must be sent in little-endian order, as defined in Internet Experiment Note 137 [N1]</p>
<h3><a class="anchor" id="autotoc_md46"></a>
2.2. Header format</h3>
<p>RTP packets contain a header. An RTP header is situated at the beginning of an RTP packet.</p>
<p>RTP Header Format:</p>
<div class="fragment"><div class="line">+-------------+---------+----------------+-----------------+</div>
<div class="line">| Packet Size | Padding | Packet Type ID | Packet Contents |</div>
<div class="line">+-------------+---------+----------------+-----------------+</div>
</div><!-- fragment --><p>where:</p>
<ul>
<li><a class="el" href="classPacket.html">Packet</a> Size: 2 bytes</li>
</ul>
<p>The size of the packet.</p>
<ul>
<li>Padding: 4 bytes</li>
</ul>
<p><b>MUST</b> be ignored.</p>
<ul>
<li><a class="el" href="classPacket.html">Packet</a> Type ID: 1 byte</li>
</ul>
<p>The ID of the packet's type, as detailed later.</p>
<ul>
<li><a class="el" href="classPacket.html">Packet</a> Contents: Variable length</li>
</ul>
<p>The packet data carried by the RTP packet. It <b>MUST</b> be at least of the size needed by the corresponding packet type to read all parameters, and <b>SHOULD</b> be of the exact needed size (although it is allowed to be too large, in which case the rest of the packet is ignored and has no effect).</p>
<h3><a class="anchor" id="autotoc_md47"></a>
2.3. Packet Parameters</h3>
<p>RTP parameters describe diverse types of values. This section describes what how each type is represented when passed through the RTP protocol.</p>
<p>Currently defined parameter types include:</p>
<h4><a class="anchor" id="autotoc_md48"></a>
2.3.1. STRING</h4>
<p>A STRING describes a sequence of characters, which <b>MUST</b> be represented in the UTF-8 encoding [N2]. Each byte of the STRING shall be passed directly without any interpretation, each one after the other. The string shall be prefixed with a 32-bit number, which indicates its length.</p>
<h4><a class="anchor" id="autotoc_md49"></a>
2.3.2. TIMESTAMP</h4>
<p>A TIMESTAMP is a 64-bit UNIX timestamp, i.e. the amount of seconds since 1970-01-01 00:00:00 +0000 (UTC).</p>
<h4><a class="anchor" id="autotoc_md50"></a>
2.3.3. U8</h4>
<p>A U8 is an 8-bit unsigned integer.</p>
<h4><a class="anchor" id="autotoc_md51"></a>
2.3.3. U16</h4>
<p>A U16 is an 16-bit unsigned integer.</p>
<h4><a class="anchor" id="autotoc_md52"></a>
2.3.4. U64</h4>
<p>A U64 is an 64-bit unsigned integer.</p>
<h3><a class="anchor" id="autotoc_md53"></a>
2.4. Packet Type IDs</h3>
<p>RTP <a class="el" href="classPacket.html">Packet</a> Type IDs are defined as described in the next paragraph. Any unrecognized data type <b>MUST</b> result in an error of some kind. <a class="el" href="classPacket.html">Packet</a> Type IDs marked "(client)" <b>MUST</b> only be sent from the client to the server, and <a class="el" href="classPacket.html">Packet</a> Type IDs marked "(server)" <b>MUST</b> only be sent from the server to the client. The description of each <a class="el" href="classPacket.html">Packet</a> Type ID begins by describing the parameters, and then the action corresponding to that <a class="el" href="classPacket.html">Packet</a> Type ID. Note that the order in which parameters are sent in the packet correspond to the order in which they are listed.</p>
<ul>
<li>Login (client) = 0</li>
<li>Keep Alive (client) = 1</li>
<li>Input (client) = 2</li>
<li>Position (client) = 3</li>
<li>Logout (client) = 4</li>
<li>Login (server) = 0</li>
<li>Keep Alive (server) = 1</li>
<li>Entity Create (server) = 2</li>
<li>Entity Destroy (server) = 3</li>
<li>Update Health (server) = 4</li>
<li>Update Position (server) = 5</li>
<li>Update Score (server) = 6</li>
</ul>
<h4><a class="anchor" id="autotoc_md54"></a>
2.4.1. Login (client)</h4>
<div class="fragment"><div class="line">+--------+</div>
<div class="line">| STRING |</div>
<div class="line">+--------+</div>
</div><!-- fragment --><p>This request sets the username used by the client. The passed STRING is the username.</p>
<h4><a class="anchor" id="autotoc_md55"></a>
2.4.2. Keep Alive (client)</h4>
<div class="fragment"><div class="line">+-----------+</div>
<div class="line">| TIMESTAMP |</div>
<div class="line">+-----------+</div>
</div><!-- fragment --><p>This request exists to make sure the server knows the client is alive. The passed TIMESTAMP indicates when the Keep Alive was sent by the sender and can be used to set up a timeout.</p>
<h4><a class="anchor" id="autotoc_md56"></a>
2.4.3. Input (client)</h4>
<div class="fragment"><div class="line">+----+</div>
<div class="line">| U8 |</div>
<div class="line">+----+</div>
</div><!-- fragment --><p>This request indicates to the server that the client has entered a certain input. The U8 shall be interpreted as a press of the Left button if it is 0, a press of the Right button if it is 1, a press of the Up button if it is 2, a press of the Down button if it is 3 and a press of the Shoot button if it is 4.</p>
<h4><a class="anchor" id="autotoc_md57"></a>
2.4.4. Position (client)</h4>
<div class="fragment"><div class="line">+-----+-----+</div>
<div class="line">| U16 | U16 |</div>
<div class="line">+-----+-----+</div>
</div><!-- fragment --><p>This request indicates to the server that the client's position has changed. The first U16 shall be interpreted as the X position of the client, and the second U16 shall be interpreted as the Y position of the client.</p>
<h4><a class="anchor" id="autotoc_md58"></a>
2.4.5. Logout (client)</h4>
<div class="fragment"><div class="line">+-+</div>
<div class="line">| |</div>
<div class="line">+-+</div>
</div><!-- fragment --><p>This request indicates to the server that the client is logging out and wishes to end the connection. It has no parameters.</p>
<h4><a class="anchor" id="autotoc_md59"></a>
2.4.6. Login (server)</h4>
<div class="fragment"><div class="line">+----+-----+</div>
<div class="line">| U8 | U16 |</div>
<div class="line">+----+-----+</div>
</div><!-- fragment --><p>This request indicates to the client that a client connected to the server. The U8 is to be taken as a state indicating the status (0 for accept, 1 for deny). The U16 is to be taken as an entity ID to be used in other requests.</p>
<h4><a class="anchor" id="autotoc_md60"></a>
2.4.7. Keep Alive (server)</h4>
<div class="fragment"><div class="line">+-----------+</div>
<div class="line">| TIMESTAMP |</div>
<div class="line">+-----------+</div>
</div><!-- fragment --><p>This request exists to make sure the client knows the server is alive. The passed TIMESTAMP indicates when the Keep Alive was sent by the sender and can be used to set up a timeout.</p>
<h4><a class="anchor" id="autotoc_md61"></a>
2.4.8. Entity Create (server)</h4>
<div class="fragment"><div class="line">+----+----+----+-----+-----+-----+-----+</div>
<div class="line">| U8 | U8 | U8 | U16 | U16 | U16 | U16 |</div>
<div class="line">+----+----+----+-----+-----+-----+-----+</div>
</div><!-- fragment --><p>This request indicates to the client that a new entity has been created. The first U8 determines the entity's type, the second U8 determines the entity's team, the third U8 determines the mob type, the first U16 determines the entity ID, the second U16 determine the X position, the third U16 determines the Y position and the fourth U16 determines the entity's life.</p>
<h4><a class="anchor" id="autotoc_md62"></a>
2.4.9. Entity Destroy (server)</h4>
<div class="fragment"><div class="line">+-----+</div>
<div class="line">| U16 |</div>
<div class="line">+-----+</div>
</div><!-- fragment --><p>This request indicates to the client that an entity has been deleted. The U16 is the entity ID of the entity that was deleted.</p>
<h4><a class="anchor" id="autotoc_md63"></a>
2.4.10. Update Health (server)</h4>
<div class="fragment"><div class="line">+-----+-----+</div>
<div class="line">| U16 | U16 |</div>
<div class="line">+-----+-----+</div>
</div><!-- fragment --><p>This request indicates to the client that an entity's life has changed. The first U16 is the entity ID of the entity hwose life changed. The second U16 is the new value for the entity's life.</p>
<h4><a class="anchor" id="autotoc_md64"></a>
2.4.11. Update Position (server)</h4>
<div class="fragment"><div class="line">+-----+-----+-----+</div>
<div class="line">| U16 | U16 | U16 |</div>
<div class="line">+-----+-----+-----+</div>
</div><!-- fragment --><p>This request indicates to the client that an entity's position has changed. The first U16 is the entity ID of the entity hwose life changed. The second U16 is the new value for the entity's X position. The third U16 is the new value for the entity's Y position.</p>
<h4><a class="anchor" id="autotoc_md65"></a>
2.4.12. Update Score (server)</h4>
<div class="fragment"><div class="line">+-----+</div>
<div class="line">| U64 |</div>
<div class="line">+-----+</div>
</div><!-- fragment --><p>This request indicates to the client that the score has changed The U64 is the new value of the score.</p>
<h2><a class="anchor" id="autotoc_md66"></a>
3. References</h2>
<h3><a class="anchor" id="autotoc_md67"></a>
3.1. Normative References</h3>
<p>[N1] Danny Cohen, "On Holy Wars and a Plea for Peace", USC/ISI, 1 April 1980, <a href="https://www.rfc-editor.org/ien/ien137.txt">https://www.rfc-editor.org/ien/ien137.txt</a></p>
<p>[N2] F. Yergeau, "UTF-8, a transformation format of ISO 10646", RFC 3629, November 2003, <a href="https://www.rfc-editor.org/rfc/rfc3629">https://www.rfc-editor.org/rfc/rfc3629</a></p>
<h3><a class="anchor" id="autotoc_md68"></a>
3.2. Informative References</h3>
<p>[I1] Postel, J., "Transmission Control Protocol", STD 7, RFC 793, DOI 10.17487/RFC0793, September 1981, <a href="https://www.rfc-editor.org/info/rfc793">https://www.rfc-editor.org/info/rfc793</a>.</p>
<p>[I2] Gabriel, R., "Reliable User Datagram Protocol", RFC, November 2022, RELIABLE-UDP-SPEC.md </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
